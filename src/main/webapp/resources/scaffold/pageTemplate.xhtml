<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
	xmlns:h="http://java.sun.com/jsf/html"
	xmlns:ui="http://java.sun.com/jsf/facelets"
	xmlns:f="http://java.sun.com/jsf/core"
	xmlns:p="http://primefaces.org/ui">
<f:view id="honeybee_view" contentType="text/html"
	locale="#{localeBean.locale}">
	<h:head>
		<title>#{empty pageTitle ? '{#pageTitle}' : pageTitle}</title>
		<link rel="icon" href="#{resource['favicon.ico']}" />
		<h:outputScript name="js.js" />
		<h:outputStylesheet name="primefaces-flick/theme.css" />
		<h:outputStylesheet name="bootstrap.css" />
		<h:outputStylesheet name="forge-style.css" />
		<h:outputStylesheet name="primefaces.css" />
		<link rel="shortcut icon" type="image/x-icon"
			href="#{request.contextPath}/resources/favicon.ico" />
		<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
	</h:head>

	<h:body onload="colorify();"
		dir="#{localeBean.locale.language != 'ar' ? 'ltr' : 'rtl'}">	
		<p:outputPanel styleClass="feedback" autoUpdate="true">
			<a target="_blank" href="mailto:kyoshuu.madani@gmail.com"> <h:outputText
					value="#{i18n.feedback}" />
			</a>
		</p:outputPanel>

		<p:ajaxStatus id="ajaxStatusPanel_reg" styleClass="status">
			<f:facet name="start">
				<div class="statusdiv">
					<h:outputText value="#{i18n.loading}" />
					<p:separator style="margin:2px;" />
					<h:graphicImage value="#{resource['gif.gif']}"
						alt="honeybee_img_loading" />
				</div>
			</f:facet>
			<f:facet name="complete">
				<h:outputText value="" style="background-color:transparent;" />
			</f:facet>
		</p:ajaxStatus>
		<p:growl autoUpdate="true" life="5000" id="growl_general"
			showDetail="false" />
		<ui:param name="html-direction"
			value="#{localeBean.locale.language != 'ar' ? 'ltr' : 'rtl'}" />
		<ui:param name="htmlDirection"
			value="#{utilityBean.htmlDirection == 'rtl' ? 'right' : 'left'}" />
		<ui:param name="isAdministrator"
			value="#{request.isUserInRole('ADMINISTRATOR')}" />
		<ui:param name="isGuest" value="#{request.isUserInRole('GUEST')}" />
		<ui:param name="isRegistered"
			value="#{request.isUserInRole('REGISTERED')}" />
		<ui:param name="isAuthor" value="#{request.isUserInRole('AUTHOR')}" />

		<script type="text/javascript">
            function colorify() {
                // var items = document.getElementById('navigation').getElementsByTagName('a');
                var topitems = document.getElementById('top_div').getElementsByTagName('a');

                var viewid = "#{utilityBean.viewName}";
                // this requires the bean to be request scoped
                if (viewid !== '/index.xhtml') {
                    document.getElementById(viewid.split('/')[1]).className = 'active-menuitem';
                }
                if (viewid === '/misc/aboutus.xhtml') {
                    topitems[1].className = 'active-topmenuitem';
                    document.getElementById('aboutus_top').className = 'active-topmenuitem';
                }
            }

            function originalView(){
			/**/ 
                }

            function customFilter(itemLabel, filterValue) {
                var label = itemLabel;
                if (label === null) {
                    return false;
                }
                return filterValue === itemValue;
            }
            </script>

		<style type="text/css">
#content h2.success {
	background-position: #{htmlDirection} 18px;
}
</style>

		<div class="navbar navbar-fixed-top">
			<div class="navbar-inner">
				<div class="container">
					<h:link id="brandLink" outcome="/index.xhtml" styleClass="brand">
						<h:outputText value="#{i18n.honeybee}" />
						<p:effect rendered="#{utilityBean.viewName.contains('index')}"
							type="pulsate" event="load" delay="500">
							<f:param name="mode" value="'show'" />
						</p:effect>
					</h:link>
					<div style="float: right;" class="nav-collapse collapse">
						<h:panelGrid columns="2" dir="ltr" id="user-panel-grid">
							<h:panelGroup styleClass="user-panel">
								<h:link id="userlink" outcome="/login.xhtml">
									<h:outputText rendered="#{not empty request.remoteUser}"
										value="#{i18n.hi} #{userManagerBean.userObject.surname}!"
										dir="#{localeBean.locale.language != 'ar' ? 'ltr' : 'rtl'}" />
								</h:link>
								<h:outputLink id="userconnect"
									value="#{request.contextPath}/signin.xhtml">
									<h:outputText rendered="#{empty request.remoteUser}"
										value="#{i18n.login}!"
										dir="#{localeBean.locale.language != 'ar' ? 'ltr' : 'rtl'}" />
								</h:outputLink>
							</h:panelGroup>

							<h:form id="form_locale" style="height:20px;"
								styleClass="onemenu">
								<p:selectOneMenu id="localemenu"
									value="#{localeBean.selectedLang}"
									style="width:120px;margin-right:1px;top:3px;"
									onchange="document.getElementById('form_locale').submit();"
									var="lang" converter="#{languageBean.converter}">
									<f:selectItem itemDisabled="true" noSelectionOption="true"
										itemLabel="#{localeBean.selectedLang.label}"
										itemValue="#{localeBean.selectedLang}" />
									<f:selectItems value="#{languageBean.all}" var="lg"
										itemLabel="#{localeBean.selectedLanguageLabel}"
										itemValue="#{lg}" />
									<p:column>
										<p:graphicImage
											value="#{request.contextPath}/javax.faces.resource/gfx/#{lang.code}.png.jsf"
											width="25" height="20" />
									</p:column>
									<p:column>
										<h:outputText value="#{lang.label}" />
									</p:column>
								</p:selectOneMenu>								
							</h:form>
						</h:panelGrid>
					</div>
					<div class="nav-collapse collapse" id="top_div">
						<ul class="nav">
							<li><h:link id="help_top" outcome="/help/search"
									value="#{i18n.help}" /></li>
							<li><h:link id="aboutus_top" outcome="/misc/aboutus"
									value="#{i18n.aboutus}" /></li>
							<li><a id="source_code" target="_blank"
								href="https://github.com/hanynowsky/honeybee"><h:outputText
										value="#{i18n.source_code}" /></a></li>
							<li><h:link id="glossary" outcome="/misc/glossary"
									value="#{i18n.glossary}" /></li>
							<li><h:link id="search_menu" outcome="/misc/search"
									value="#{i18n.search}" /></li>
						</ul>
					</div>
				</div>
			</div>
		</div>

		<div class="container forgecontainer">
			<div id="navigation">
				<h:link id="homeLink" outcome="/index.xhtml"
					style="padding-left:0px;">
					<img src="#{resource['bee.jpg']}" alt="HoneyBee" border="0"
						style="border: 3px solid #FFF; width: 180px; border-radius: 5px; text-align: center; margin-bottom: 5px; box-shadow: 0 1px 1px rgba(0, 0, 0, 0.075) inset, 0 0 8px rgba(0, 0, 0, 0.6);">
					</img>
				</h:link>
				<h:panelGroup rendered="#{isAdministrator == true}">
					<ul>
						<li><h:link id="language" outcome="/language/search"
								value="#{i18n.languages}" /></li>
						<li><h:link id="usergroup" outcome="/usergroup/search"
								value="#{i18n.usergroup}" /></li>
						<li><h:link id="enduser" outcome="/enduser/search"
								value="#{i18n.endusers}" /></li>
					</ul>
				</h:panelGroup>

				<h:panelGroup>
					<ul>
						<li><h:link id="prescription" outcome="/prescription/search"
								value="#{i18n.prescriptions}" /></li>
						<li><h:link id="author" outcome="/author/search"
								value="#{i18n.authors}" /></li>
						<li><h:link id="witness" outcome="/witness/search"
								value="#{i18n.witnesses}" /></li>
					</ul>
				</h:panelGroup>
				<h:panelGroup>
					<ul>
						<li><h:link id="virtue" outcome="/virtue/search"
								value="#{i18n.virtues}" /></li>
						<li><h:link id="defect" outcome="/defect/search"
								value="#{i18n.defects}" /></li>
						<li><h:link id="bodypart" outcome="/bodypart/search"
								value="#{i18n.bodyparts}" /></li>
					</ul>
				</h:panelGroup>
				<h:panelGroup>
					<ul>
						<li><h:link id="ingredient" outcome="/ingredient/search"
								value="#{i18n.ingredients}" /></li>
						<li><h:link id="complement" outcome="/complement/search"
								value="#{i18n.complements}" /></li>
						<li><h:link id="honey" outcome="/honey/search"
								value="#{i18n.honey}" /></li>
						<li><h:link id="plant" outcome="/plant/search"
								value="#{i18n.plants}" /></li>
						<li><h:link id="substance" outcome="/substance/search"
								value="#{i18n.substances}" /></li>
					</ul>
				</h:panelGroup>
				<h:panelGroup>
					<ul>
						<li><h:link id="store" outcome="/store/search"
								value="#{i18n.stores}" /></li>
					</ul>
				</h:panelGroup>
			</div>

			<div id="content">
				<h1>
					<ui:insert name="header" />
				</h1>
				<h2>
					<ui:insert name="subheader" />
				</h2>
				<h:form>
					<p:messages globalOnly="true" id="messages_global"
						showDetail="false">
						<p:effect type="pulsate" event="load" delay="500">
							<f:param name="mode" value="'show'" />
						</p:effect>
					</p:messages>

					<p:idleMonitor onidle="idleDialog.show();" id="idleMonitor"
						timeout="1740000">
						<p:ajax event="idle"
							listener="#{utilityBean.showMessage('info','IDLE','-')}"
							update="messages_global" />
					</p:idleMonitor>
					<p:dialog header="HoneyBee" widgetVar="idleDialog" modal="true"
						closable="false">
						<h:panelGrid columns="1" style="text-align:center;">
							<h:outputText value="Expired Session!" />
							<p:separator style="height:1px;" />
							<p:commandButton value="#{i18n.logout}"
								action="#{userManagerBean.logout}" ajax="false" />
						</h:panelGrid>
					</p:dialog>
				</h:form>

				<ui:insert name="main" />
			</div>
		</div>

		<footer>		
			<div id="footer-wrapper">
				<p>
					<h:outputText value="#{i18n.powered_by}" />
					<a href="http://opentika-otika.rhcloud.com"> <h:outputText
							value="OpenTika" />
					</a>
					<h:outputText value=" | @2013 - #{i18n.casablanca}" />						
				</p>
			</div>
		</footer>
	</h:body>
</f:view>
</html>
